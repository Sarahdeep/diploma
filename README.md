# Наименование проекта (Замените на актуальное название вашего проекта)

Данный документ содержит инструкции по установке, настройке, запуску и управлению проектом.

## 1. Предварительные требования

Перед началом работы убедитесь, что в вашей системе установлены следующие компоненты:
*   **Git**: Система контроля версий для клонирования репозитория.
*   **Docker**: Платформа для запуска приложений в изолированных контейнерах.
*   **Docker Compose**: Инструмент для определения и управления многоконтейнерными Docker-приложениями.

Для корректной работы приложения рекомендуется наличие как минимум 4 ГБ оперативной памяти и 10 ГБ свободного дискового пространства.

## 2. Инструкции по установке и настройке

Для развертывания и запуска проекта необходимо выполнить следующие шаги:

### 2.1. Клонирование репозитория
Склонируйте репозиторий проекта на ваш локальный компьютер. Замените `your-repository-url.git` на фактический URL-адрес вашего Git-репозитория.
```bash
git clone your-repository-url.git
cd имя-вашей-директории-проекта # Перейдите в корневую директорию склонированного проекта
```

### 2.2. Конфигурация серверной части (Backend)
Перейдите в директорию `app` (или в корневую директорию проекта, если файл `.env` для backend должен располагаться там) и создайте файл `.env`.
```bash
cd app # или соответствующая директория для .env серверной части
touch .env
```
Заполните файл `app/.env` необходимыми переменными окружения. Пример конфигурации, основанный на вашем `docker-compose.yml` и общих требованиях:

```env
# Общие параметры
SECRET_KEY=your_strong_secret_key_here # ВАЖНО: Замените на надежный ключ для производственной среды
REFRESH_SECRET_KEY=your_strong_refresh_secret_key_here # ВАЖНО: Замените на надежный ключ для производственной среды
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES=15
EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24
DISABLE_AUTH=false # Установите true для отключения аутентификации в режиме разработки (при необходимости)
DEV_MODE=true # Установите false в производственной среде для безопасных cookie

# База данных (PostgreSQL)
DATABASE_URL=postgresql://user:password@db:5432/mydb

# Redis
REDIS_URL=redis://redis:6379 # Убедитесь, что порт соответствует docker-compose, если он был изменен

# Объектное хранилище MinIO
MINIO_ENDPOINT=minio:9000
MINIO_PUBLIC_URL=http://localhost:9000 # URL, доступный из браузера пользователя
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_SECURE=False # Установите True, если MinIO сконфигурирован с HTTPS

# Конфигурация электронной почты (Опционально, для функций сброса пароля, верификации email и т.д.)
MAIL_USERNAME=your_smtp_username
MAIL_PASSWORD=your_smtp_password
MAIL_FROM=your_sender_email@example.com
MAIL_PORT=587 # Или ваш SMTP порт
MAIL_SERVER=your_smtp_server.example.com
MAIL_STARTTLS=True
MAIL_SSL_TLS=False
# EMAIL_ENABLED=True # Установите False, если не используются функции email или MAIL_SERVER не настроен

# URL клиентской части (для генерации ссылок в письмах и т.д.)
FRONTEND_URL=http://localhost:3000

# Celery (если требуются специфичные настройки помимо URL Redis/БД)
# CELERY_BROKER_URL=${REDIS_URL}/0
# CELERY_RESULT_BACKEND=${REDIS_URL}/0
```
**Примечание**: `MINIO_ACCESS_KEY` и `MINIO_SECRET_KEY` должны совпадать с `MINIO_ROOT_USER` и `MINIO_ROOT_PASSWORD` из вашего файла `docker-compose.yml`, если вы используете стандартную конфигурацию MinIO.

### 2.3. Конфигурация клиентской части (Frontend)
Перейдите в директорию `frontend` и создайте файл `.env`.
```bash
cd ../frontend # Предполагается, что вы находились в директории 'app'
touch .env
```
Заполните файл `frontend/.env` необходимыми переменными окружения для клиентского приложения. Как правило, это включает базовый URL API:
```env
VITE_API_BASE_URL=http://localhost:8000/api/v1 # Измените, если префикс вашего API отличается
# Добавьте здесь другие переменные окружения, специфичные для frontend
```
**Примечание**: `VITE_API_BASE_URL` должен указывать на ваш API серверной части. Путь `/api/v1` является примером; скорректируйте его в соответствии с конфигурацией маршрутизации вашего backend.

## 3. Запуск приложения

После конфигурации файлов окружения можно собрать образы и запустить все сервисы с помощью Docker Compose. Перейдите в корневую директорию проекта (где находится файл `docker-compose.yml`).

```bash
cd .. # Вернитесь в корневую директорию проекта из директории frontend
docker-compose up -d --build
```
Данная команда выполнит следующие действия:
*   Соберет Docker-образы для сервисов `app` (серверная часть), `celery_worker` и `frontend`, если они отсутствуют или их Dockerfile были изменены.
*   Запустит все сервисы, определенные в `docker-compose.yml`, в фоновом режиме (`-d`).

Для проверки статуса контейнеров:
```bash
docker-compose ps
```
Для просмотра логов конкретного сервиса (например, сервиса `app`):
```bash
docker-compose logs -f app
```

## 4. Доступ к приложению

После запуска сервисов:
*   **Клиентское приложение (Frontend)**: Откройте веб-браузер и перейдите по адресу `http://localhost:3000`
*   **API серверной части (Backend)**: API будет доступен по адресу `http://localhost:8000` (например, документация Swagger UI может находиться по адресу `http://localhost:8000/docs`)
*   **Консоль MinIO**: Доступ к веб-консоли Minio осуществляется по адресу `http://localhost:9001` (используйте `minioadmin`/`minioadmin` или учетные данные, указанные в `docker-compose.yml`).
*   **База данных**: PostgreSQL доступна на порту `5432`.
*   **Redis**: Redis доступен на порту `6379`.

## 5. Остановка приложения

Для остановки всех запущенных сервисов:
```bash
docker-compose down
```
Если необходимо также удалить тома (volumes), что приведет к удалению данных вашей БД и MinIO:
```bash
docker-compose down -v
```

## 6. Обзор структуры проекта

*   `/app`: Содержит приложение FastAPI (серверная часть).
    *   `main.py`: Основная точка входа приложения.
    *   `endpoints/`: Определения API-эндпоинтов.
    *   `models.py`: Модели базы данных SQLAlchemy.
    *   `schemas.py`: Схемы данных Pydantic.
    *   `celery_tasks/`: Определения задач Celery.
    *   `.env`: Файл конфигурации окружения серверной части (необходимо создать).
*   `/frontend`: Содержит клиентское приложение (например, Vue, React, Angular).
    *   `src/`: Исходный код клиентской части.
    *   `.env`: Файл конфигурации окружения клиентской части (необходимо создать).
    *   `Dockerfile`: Инструкции по сборке Docker-образа для клиентской части.
*   `docker-compose.yml`: Определяет и конфигурирует все сервисы проекта (backend, frontend, база данных, Redis, MinIO, Celery worker).
*   `Dockerfile`: Инструкции по сборке Docker-образа для серверного приложения.
*   `requirements.txt`: Зависимости Python для серверной части.

## 7. Устранение неполадок

*   **Конфликты портов**: При возникновении ошибок, связанных с занятостью портов, убедитесь, что порты `8000`, `3000`, `5432`, `6379`, `9000`, `9001` не используются другими приложениями, или остановите эти приложения.
*   **Проблемы с файлами `.env`**: Дважды проверьте корректность имен файлов `.env` (`app/.env` и `frontend/.env`), их расположение в правильных директориях, а также правильность имен переменных и их значений.
*   **Docker/Docker Compose не найден**: Убедитесь, что Docker и Docker Compose корректно установлены и доступны в системной переменной PATH.
*   **Проблемы с подключением сервисов**:
    *   Если клиентская часть не может подключиться к серверной, проверьте `VITE_API_BASE_URL` в `frontend/.env` и убедитесь, что сервис `app` (backend) работает корректно (`docker-compose ps`).
    *   Если серверная часть не может подключиться к базе данных или Redis, проверьте `DATABASE_URL` и `REDIS_URL` в `app/.env` и изучите логи сервисов `db` и `redis`.
*   **Проблемы с миграциями (если применимо)**: Если ваш проект использует миграции базы данных (например, Alembic), убедитесь, что они применяются корректно. Ваш `docker-compose.yml` может содержать команду для этого, либо их потребуется выполнить вручную внутри контейнера `app`.
*   **Ошибка "No such file or directory" для .env во время сборки**: Убедитесь, что файлы `.env` *не* перечислены в `.dockerignore`, если их необходимо копировать в образ (хотя обычно рекомендуется использовать `.env` файлы во время выполнения, а не копировать их в образы). Ваша текущая конфигурация корректно использует переменные окружения, передаваемые из `docker-compose.yml` или монтируемые во время выполнения файлы `.env`, что является предпочтительной практикой.

## 8. Обновление приложения

Для обновления приложения до последней версии из репозитория:
1.  Загрузите последние изменения: `git pull origin main` (или имя вашей ветки).
2.  Пересоберите образы и перезапустите сервисы: `docker-compose up -d --build`.

## 9. Аспекты безопасности

*   **Надежные секретные ключи**: Всегда используйте сложные, уникальные значения для `SECRET_KEY`, `REFRESH_SECRET_KEY`, паролей к базе данных и ключей MinIO в ваших `.env` файлах, особенно в производственной среде.
*   **Переменные окружения**: Не добавляйте файлы `.env`, содержащие чувствительные данные, в систему контроля версий Git. Добавьте их в файл `.gitignore`.
*   **Регулярные обновления**: Своевременно обновляйте зависимости (пакеты Python, модули Node, образы Docker) для устранения уязвимостей безопасности.
*   **Сетевая доступность**: Открывайте для хост-машины или внешнего доступа только необходимые порты. В `docker-compose.yml` сервисы, такие как `db` и `redis`, обычно не требуют маппинга портов на `localhost`, если к ним обращаются только другие контейнеры в сети Docker.
*   **HTTPS**: В производственной среде настройте HTTPS для клиентской и серверной частей приложения.

Данное руководство должно помочь вам начать работу с проектом. В случае возникновения проблем, не описанных здесь, обратитесь к специфической документации проекта или лог-файлам для получения более подробной информации. 